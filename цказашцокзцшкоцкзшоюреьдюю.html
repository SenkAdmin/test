<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark" />
  <meta name="theme-color" content="#0a0b0e" />
  <title>Senk - портфолио</title>
  <meta name="description" content="Сэнг — дизайнер / веб-разработчик / разработчик Telegram-ботов. Премиальный минимализм, кейсы и проекты." />
  <link rel="preload" as="image" href="assets/seng.jpg" fetchpriority="high">
  <link rel="preload" as="image" href="assets/projects/landing/01.jpg">

  <style>
    :root{
      --bg:#0a0b0e;
      --ink:rgba(255,255,255,.92);
      --glassA:rgba(255,255,255,.075);
      --glassB:rgba(255,255,255,.045);
      --strokeB:rgba(255,255,255,.08);
      --sh2:0 12px 26px rgba(0,0,0,.42);
      --rXL:28px;
      --rLG:22px;
      --rMD:18px;
      --pad:clamp(16px,3.8vw,28px);
      --gap2:18px;
      --font:ui-sans-serif,system-ui,-apple-system,"SF Pro Display","SF Pro Text","Segoe UI",Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      --ease:cubic-bezier(.18,.9,.22,1);
      --ease2:cubic-bezier(.2,.7,.2,1);
      --d1:520ms;
      --d2:280ms;
      --headerH:64px;
      --socialBarH:0px;
    }

    *{box-sizing:border-box;}
    html,body{height:100%;}
    body{
      margin:0;
      font-family:var(--font);
      color:var(--ink);
      background:var(--bg);
      overflow-x:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    @media (prefers-reduced-motion: reduce){
      *{
        animation-duration:1ms!important;
        animation-iteration-count:1!important;
        transition-duration:1ms!important;
        scroll-behavior:auto!important;
      }
    }
    a{color:inherit;text-decoration:none;}
    button{font:inherit;}

    .bg{
      position:fixed;
      inset:0;
      z-index:-3;
      background:#0a0b0e;
      overflow:hidden;
    }
    .bg::before{
      content:"";
      position:absolute;
      inset:-30%;
      background:
        radial-gradient(60% 40% at 20% 10%, rgba(255,255,255,.055), transparent 65%),
        radial-gradient(55% 45% at 80% 20%, rgba(255,255,255,.045), transparent 66%),
        radial-gradient(45% 55% at 55% 85%, rgba(255,255,255,.035), transparent 70%),
        radial-gradient(60% 60% at 40% 55%, rgba(255,255,255,.02), transparent 72%);
      filter:blur(28px);
      transform:translate3d(0,0,0);
      opacity:.95;
      will-change:transform;
    }
    .bg::after{
      content:"";
      position:absolute;
      inset:0;
      background:radial-gradient(120% 120% at 50% 50%, transparent 55%, rgba(0,0,0,.55) 100%);
      pointer-events:none;
      opacity:.85;
    }

    .noise{
      position:fixed;
      inset:0;
      z-index:-2;
      pointer-events:none;
      opacity:.055;
      mix-blend-mode:overlay;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
    }

    #fx{
      position:fixed;
      inset:0;
      z-index:-1;
      pointer-events:none;
    }

    .wrap{
      width:min(1120px,100%);
      margin:0 auto;
      padding:calc(var(--pad) + var(--headerH)) var(--pad) calc(96px + var(--socialBarH));
    }

    section{scroll-margin-top:calc(var(--headerH) + 16px);}

    .glass{
      background:linear-gradient(180deg,var(--glassA),var(--glassB));
      border:1px solid var(--strokeB);
      box-shadow:var(--sh2);
      backdrop-filter:blur(18px);
      -webkit-backdrop-filter:blur(18px);
    }
    .panel{border-radius:var(--rXL);overflow:hidden;}
    .card{border-radius:var(--rLG);overflow:hidden;transform:translateZ(0);contain:paint;}

    header{
      position:fixed;
      top:0;
      left:0;right:0;
      height:var(--headerH);
      z-index:50;
      display:grid;
      place-items:center;
      padding:env(safe-area-inset-top) 10px 0;
      pointer-events:none;
    }
    .bar{
      pointer-events:auto;
      width:min(1120px,calc(100% - 18px));
      height:54px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      transition:background var(--d2) var(--ease2),border-color var(--d2) var(--ease2),backdrop-filter var(--d2) var(--ease2);
      background:rgba(12,14,18,.38);
      border:1px solid rgba(255,255,255,.10);
      backdrop-filter:blur(16px);
      -webkit-backdrop-filter:blur(16px);
      box-shadow:0 22px 70px rgba(0,0,0,.55);
    }
    .bar.is-scrolled{
      background:rgba(12,14,18,.52);
      border-color:rgba(255,255,255,.13);
      backdrop-filter:blur(20px);
      -webkit-backdrop-filter:blur(20px);
    }

    .brand{display:flex;align-items:center;gap:10px;padding-left:6px;min-width:120px;}
    .brand .dot{
      width:10px;height:10px;border-radius:999px;
      background:rgba(255,255,255,.38);
      box-shadow:0 0 0 6px rgba(255,255,255,.06);
    }
    .brand strong{
      font-size:14px;
      letter-spacing:.2px;
      font-weight:760;
      color:rgba(255,255,255,.90);
    }
    .brand span{
      font-size:12px;
      color:rgba(255,255,255,.45);
      letter-spacing:.12px;
      display:none;
    }
    @media (min-width:860px){.brand span{display:block;}}

    nav{display:flex;gap:8px;align-items:center;flex:1;justify-content:center;}
    .navbtn{
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.04);
      color:rgba(255,255,255,.78);
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      letter-spacing:.15px;
      cursor:pointer;
      transition:transform var(--d2) var(--ease2),background var(--d2) var(--ease2),border-color var(--d2) var(--ease2),box-shadow var(--d2) var(--ease2);
      -webkit-tap-highlight-color:transparent;
      user-select:none;
    }
    .navbtn:active{transform:scale(.98);}
    @media (hover:hover){
      .navbtn:hover{
        background:rgba(255,255,255,.06);
        border-color:rgba(255,255,255,.14);
        transform:translateY(-1px);
      }
    }
    .navbtn:focus-visible{outline:none;box-shadow:0 0 0 3px rgba(255,255,255,.14);}

    .fxswitch{display:flex;align-items:center;gap:6px;padding-right:6px;min-width:148px;justify-content:flex-end;}
    .seg{
      display:flex;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
      border-radius:999px;
      overflow:hidden;
      backdrop-filter:blur(10px);
      -webkit-backdrop-filter:blur(10px);
    }
    .seg button{
      border:none;
      background:transparent;
      color:rgba(255,255,255,.62);
      padding:9px 10px;
      cursor:pointer;
      font-size:12px;
      letter-spacing:.12px;
      transition:background var(--d2) var(--ease2),color var(--d2) var(--ease2);
      min-width:42px;
      -webkit-tap-highlight-color:transparent;
    }
    .seg button[aria-pressed="true"]{background:rgba(255,255,255,.08);color:rgba(255,255,255,.88);}
    .seg button:active{transform:translateY(.5px);}
    .seg button:focus-visible{outline:none;box-shadow:inset 0 0 0 2px rgba(255,255,255,.14);}

    @media (max-width:420px){
      .brand{min-width:92px;}
      .fxswitch{min-width:120px;}
      .navbtn{padding:10px 10px;font-size:12.5px;}
      .seg button{padding:9px 9px;}
    }

    .hero{padding:18px;}
    .hero-grid{display:grid;grid-template-columns:1fr;gap:14px;align-items:center;}
    .hero-right{display:flex;justify-content:flex-end;opacity:.95;}
    .hero-photo{
      width:min(240px,58vw);
      aspect-ratio:1/1;
      border-radius:26px;
      object-fit:cover;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
      box-shadow:0 18px 44px rgba(0,0,0,.45),0 0 0 6px rgba(255,255,255,.04);
      filter:saturate(.92) contrast(1.02) brightness(.96);
      transform:translateZ(0);
      user-select:none;
      -webkit-user-drag:none;
    }
    @media (min-width:860px){
      .hero-grid{grid-template-columns:1.2fr .8fr;gap:10px;}
      .hero{padding:20px;}
    }
    @media (max-width:520px){
      .hero-right{justify-content:center;margin-top:4px;}
      .hero-photo{width:min(220px,74vw);border-radius:22px;}
    }

    .title{
      margin:2px 0 8px;
      font-size:clamp(28px,6vw,46px);
      line-height:1.06;
      letter-spacing:-0.7px;
      font-weight:820;
      display:flex;
      align-items:baseline;
      gap:6px;
    }
    #titleText{display:inline-block;}
    .caret{
      display:inline-block;
      width:10px;
      height:1em;
      border-right:2px solid rgba(255,255,255,.65);
      transform:translateY(1px);
      opacity:.85;
      animation:blink 1s steps(2,end) infinite;
    }
    @keyframes blink{50%{opacity:0;}}
    @media (prefers-reduced-motion: reduce){
      .caret{animation:none;opacity:0;}
    }

    .subtitle{
      margin:0;
      font-size:clamp(13px,2.8vw,16px);
      line-height:1.55;
      color:rgba(255,255,255,.66);
      max-width:62ch;
    }
    .subline{
      margin:10px 0 0;
      font-size:12.5px;
      color:rgba(255,255,255,.44);
      letter-spacing:.15px;
    }

    .section{margin-top:18px;}
    .section-head{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:10px;
      margin:12px 2px 12px;
    }
    .h2{
      margin:0;
      font-size:15.5px;
      letter-spacing:.18px;
      font-weight:720;
      color:rgba(255,255,255,.85);
    }

    .grid{display:grid;gap:var(--gap2);}
    @media (min-width:860px){
      .grid.projects{grid-template-columns:repeat(3,1fr);}
      .grid.cases{grid-template-columns:repeat(3,1fr);}
    }

    .card-inner{padding:12px;display:grid;gap:10px;}
    .meta h3{
      margin:0;
      font-size:14px;
      letter-spacing:.18px;
      font-weight:720;
      color:rgba(255,255,255,.88);
    }
    .meta p{
      margin:6px 0 0;
      font-size:12.5px;
      line-height:1.45;
      color:rgba(255,255,255,.58);
    }

    .viewer{
      position:relative;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
      background:rgba(255,255,255,.03);
      box-shadow:0 12px 24px rgba(0,0,0,.35);
      touch-action:pan-y pinch-zoom;
      transform:translateZ(0);
    }
    .track{
      display:flex;
      width:400%;
      transform:translate3d(var(--x,0px),0,0);
      will-change:transform;
      transition:transform var(--d2) var(--ease2);
    }
    .slide{width:25%;aspect-ratio:16/11;background:rgba(255,255,255,.02);}
    .slide img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      filter:saturate(.92) contrast(1.02) brightness(.95);
      transform:scale(1.02);
      user-select:none;
      -webkit-user-drag:none;
      content-visibility:auto;
      contain-intrinsic-size:400px 275px;
    }

    .pill{
      position:absolute;
      left:10px;
      bottom:10px;
      display:flex;
      gap:6px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(10,11,14,.32);
      backdrop-filter:blur(12px);
      -webkit-backdrop-filter:blur(12px);
      box-shadow:0 10px 18px rgba(0,0,0,.35);
      z-index:2;
      pointer-events:none;
      opacity:1;
      transform:translateY(0);
      transition:opacity var(--d2) var(--ease2), transform var(--d2) var(--ease2);
    }
    .viewer[data-pill-hidden="true"] .pill{
      opacity:0;
      transform:translateY(6px);
    }
    .pill i{
      width:6px;height:6px;border-radius:999px;
      background:rgba(255,255,255,.25);
      display:inline-block;
    }
    .pill i.on{background:rgba(255,255,255,.72);}

    .actions{display:flex;align-items:center;justify-content:space-between;gap:10px;padding-top:6px;}
    .mini{
      font-size:12px;
      color:rgba(255,255,255,.42);
      letter-spacing:.12px;
      display:flex;
      align-items:center;
      gap:8px;
      min-width:92px;
    }
    .barline{
      height:2px;
      width:100%;
      max-width:120px;
      border-radius:999px;
      background:rgba(255,255,255,.10);
      overflow:hidden;
      flex:1;
    }
    .barline > i{
      display:block;
      height:100%;
      width:var(--p,25%);
      border-radius:999px;
      background:rgba(255,255,255,.32);
    }

    .btn{
      appearance:none;
      border:none;
      cursor:pointer;
      padding:12px 14px;
      border-radius:16px;
      background:rgba(255,255,255,.07);
      color:rgba(255,255,255,.86);
      border:1px solid rgba(255,255,255,.14);
      box-shadow:0 14px 32px rgba(0,0,0,.45);
      backdrop-filter:blur(12px);
      -webkit-backdrop-filter:blur(12px);
      transition:transform var(--d2) var(--ease2), background var(--d2) var(--ease2), border-color var(--d2) var(--ease2), box-shadow var(--d2) var(--ease2);
      font-weight:700;
      letter-spacing:.15px;
      font-size:13px;
      -webkit-tap-highlight-color:transparent;
      user-select:none;
    }
    .btn:active{transform:scale(.98);}
    @media (hover:hover){
      .btn:hover{
        transform:translateY(-1px);
        background:rgba(255,255,255,.09);
        border-color:rgba(255,255,255,.18);
      }
    }
    .btn.secondary{
      background:rgba(255,255,255,.045);
      border-color:rgba(255,255,255,.12);
      box-shadow:0 12px 24px rgba(0,0,0,.36);
      font-weight:650;
    }

    .case-card{cursor:default;transition:transform var(--d2) var(--ease2);outline:none;}
    @media (hover:hover){.case-card:hover{transform:translateY(-2px);}}

    .modal{position:fixed;inset:0;display:none;z-index:100;}
    .modal[aria-hidden="false"]{display:block;}
    .backdrop{
      position:absolute;
      inset:0;
      background:rgba(0,0,0,.58);
      backdrop-filter:blur(12px);
      -webkit-backdrop-filter:blur(12px);
      opacity:0;
      transition:opacity var(--d2) var(--ease2);
    }
    .modal[aria-hidden="false"] .backdrop{opacity:1;}

    .sheet{
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%) translate3d(0,10px,0) scale(.99);
      width:min(980px,calc(100% - 20px));
      max-height:min(84vh,900px);
      display:grid;
      gap:14px;
      padding:14px;
      border-radius:28px;
      border:1px solid rgba(255,255,255,.12);
      background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));
      box-shadow:0 40px 110px rgba(0,0,0,.65);
      backdrop-filter:blur(22px);
      -webkit-backdrop-filter:blur(22px);
      opacity:0;
      transition:opacity var(--d1) var(--ease), transform var(--d1) var(--ease);
      contain:layout paint;
      will-change:transform,opacity;
    }
    .modal[aria-hidden="false"] .sheet{
      opacity:1;
      transform:translate(-50%,-50%) translate3d(0,0,0) scale(1);
    }
    .sheet.case{grid-template-columns:1.25fr 1fr;}
    .sheet.photo{width:min(980px,calc(100% - 20px));grid-template-columns:1fr;padding:12px;}

    @media (max-width:860px){
      .sheet{
        top:auto;
        bottom:10px;
        left:50%;
        transform:translate(-50%,14px) scale(.99);
        width:calc(100% - 18px);
        max-height:88vh;
        border-radius:26px;
        padding:12px;
      }
      .modal[aria-hidden="false"] .sheet{transform:translate(-50%,0) scale(1);}
      .sheet.case{grid-template-columns:1fr;}
    }

    .modal-top{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:6px 6px 0 6px;}
    .modal-title{margin:0;font-size:12.5px;color:rgba(255,255,255,.55);letter-spacing:.12px;}
    .close{
      width:42px;height:42px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      display:grid;place-items:center;
      cursor:pointer;
      transition:transform var(--d2) var(--ease2), background var(--d2) var(--ease2);
      -webkit-tap-highlight-color:transparent;
    }
    .close:active{transform:scale(.98);}
    @media (hover:hover){.close:hover{transform:translateY(-1px);background:rgba(255,255,255,.08);}}
    .icon{width:18px;height:18px;opacity:.9;}

    .modal-left{display:grid;gap:10px;padding:6px;}
    .navrow{display:flex;gap:10px;justify-content:flex-end;padding:0 6px 6px;}

    .iconbtn{
      width:48px;height:48px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      box-shadow:0 12px 26px rgba(0,0,0,.42);
      display:grid;place-items:center;
      cursor:pointer;
      backdrop-filter:blur(12px);
      -webkit-backdrop-filter:blur(12px);
      transition:transform var(--d2) var(--ease2), background var(--d2) var(--ease2);
      -webkit-tap-highlight-color:transparent;
    }
    .iconbtn:active{transform:scale(.98);}
    @media (hover:hover){.iconbtn:hover{transform:translateY(-1px);background:rgba(255,255,255,.08);}}

    .modal-right{padding:10px 10px 10px 8px;display:grid;align-content:start;gap:10px;}
    .case-name{margin:0;font-size:18px;letter-spacing:-0.2px;font-weight:780;color:rgba(255,255,255,.90);}
    .case-desc{margin:0;color:rgba(255,255,255,.60);font-size:13px;line-height:1.55;}
    .work-list{margin:6px 0 0 0;padding:0;list-style:none;display:grid;gap:8px;}
    .work-list li{
      display:flex;gap:10px;align-items:flex-start;
      padding:10px 10px;border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.04);
    }
    .work-list .b{
      width:8px;height:8px;border-radius:999px;
      background:rgba(255,255,255,.30);
      margin-top:6px;
      flex:0 0 auto;
    }
    .work-list span{color:rgba(255,255,255,.64);font-size:12.5px;line-height:1.45;}

    .sr-only{
      position:absolute!important;
      width:1px;height:1px;
      padding:0;margin:-1px;
      overflow:hidden;clip:rect(0,0,0,0);
      white-space:nowrap;border:0;
    }

    .socials-float{
      position:relative;
      z-index:1;
      display:flex;
      justify-content:center;
      gap:14px;
      padding:16px 14px calc(16px + env(safe-area-inset-bottom));
      margin-top:24px;
      pointer-events:auto;
    }
    .socials-float .social{
      pointer-events:auto;
      width:62px;height:62px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      display:grid;place-items:center;
      cursor:pointer;
      -webkit-tap-highlight-color:transparent;
      transform:translateZ(0);
      transition:transform var(--d2) var(--ease2), background var(--d2) var(--ease2), border-color var(--d2) var(--ease2), box-shadow var(--d2) var(--ease2);
      box-shadow:0 14px 30px rgba(0,0,0,.42);
    }
    .socials-float .social svg{width:25px;height:25px;display:block;transform:translateZ(0);shape-rendering:geometricPrecision;}
    .socials-float .social:active{transform:scale(.98);}
    @media (hover:hover){
      .socials-float .social:hover{
        transform:translateY(-2px);
        background:rgba(255,255,255,.08);
        border-color:rgba(255,255,255,.18);
        box-shadow:0 18px 38px rgba(0,0,0,.46),0 0 0 3px rgba(255,255,255,.06);
      }
    }
    .socials-float .social:focus-visible{
      outline:none;
      box-shadow:0 18px 38px rgba(0,0,0,.46),0 0 0 3px rgba(255,255,255,.14);
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="noise" aria-hidden="true"></div>
  <canvas id="fx" aria-hidden="true"></canvas>

  <header>
    <div class="bar glass" id="bar">
      <div class="brand" aria-label="Бренд">
        <span class="dot" aria-hidden="true"></span>
        <strong>Senk</strong>
        <span>portfolio</span>
      </div>

      <nav aria-label="Навигация">
        <button class="navbtn" type="button" data-scroll="#projects">Проекты</button>
        <button class="navbtn" type="button" data-scroll="#cases">Кейсы</button>
        <button class="navbtn" type="button" data-scroll="#contacts">Контакты</button>
      </nav>

      <div class="fxswitch" aria-label="Осадки">
        <div class="seg" role="group" aria-label="Режим осадков">
          <button type="button" class="fxbtn" data-fx="rain" aria-pressed="false" title="Дождь">Rain</button>
          <button type="button" class="fxbtn" data-fx="snow" aria-pressed="false" title="Снег">Snow</button>
          <button type="button" class="fxbtn" data-fx="off"  aria-pressed="true"  title="Выключено">Off</button>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero glass panel">
      <div class="hero-grid">
        <div class="hero-left">
          <h1 class="title"><span id="titleText">Senk</span><span class="caret" aria-hidden="true"></span></h1>
          <p class="subtitle">
            Дизайнер / Веб-разработчик / Разработчик Telegram-ботов
            <br />
            Делаю тихие премиальные интерфейсы в графитовом стиле — стекло, глубина, аккуратные микродвижения.
            Фокус: мобильный UX и чистая визуальная иерархия.
          </p>
          <p class="subline">Свайпай проекты • открывай кейсы • заказывай через Telegram</p>
        </div>

        <div class="hero-right">
          <img class="hero-photo" src="assets/seng.jpg" alt="Сэнг" loading="eager" decoding="async" fetchpriority="high">
        </div>
      </div>
    </section>

    <section class="section" id="projects">
      <div class="section-head">
        <h2 class="h2">Избранные проекты</h2>
      </div>

      <div class="grid projects">
        <article class="glass card">
          <div class="card-inner">
            <div class="viewer js-viewer"
                 data-kind="project"
                 data-title="Лендинг продукта"
                 data-images="assets/projects/landing/01.jpg,assets/projects/landing/02.jpg,assets/projects/landing/03.jpg,assets/projects/landing/04.jpg">
              <div class="track"></div>
              <div class="pill" aria-hidden="true"><i class="on"></i><i></i><i></i><i></i></div>
            </div>

            <div class="meta">
              <h3>Лендинг продукта (Web)</h3>
              <p>Стеклянные панели, чистая композиция, плотный UX. Быстро, тихо, “дорого”.</p>
            </div>

            <div class="actions">
              <div class="mini">
                <span>4 кадра</span>
                <span class="barline" aria-hidden="true"><i style="--p:25%"></i></span>
              </div>
              <button class="btn secondary js-photo" type="button">Фото</button>
            </div>
          </div>
        </article>

        <article class="glass card">
          <div class="card-inner">
            <div class="viewer js-viewer"
                 data-kind="project"
                 data-title="Telegram-бот"
                 data-images="assets/projects/bot/01.jpg,assets/projects/bot/02.jpg,assets/projects/bot/03.jpg,assets/projects/bot/04.jpg">
              <div class="track"></div>
              <div class="pill" aria-hidden="true"><i class="on"></i><i></i><i></i><i></i></div>
            </div>

            <div class="meta">
              <h3>Telegram-бот (Flow + UI)</h3>
              <p>Сценарии, клавиатуры, логика, интеграции. Максимум простоты, минимум шума.</p>
            </div>

            <div class="actions">
              <div class="mini">
                <span>4 кадра</span>
                <span class="barline" aria-hidden="true"><i style="--p:50%"></i></span>
              </div>
              <button class="btn secondary js-photo" type="button">Фото</button>
            </div>
          </div>
        </article>

        <article class="glass card">
          <div class="card-inner">
            <div class="viewer js-viewer"
                 data-kind="project"
                 data-title="Дизайн-пак"
                 data-images="assets/projects/designpack/01.jpg,assets/projects/designpack/02.jpg,assets/projects/designpack/03.jpg,assets/projects/designpack/04.jpg">
              <div class="track"></div>
              <div class="pill" aria-hidden="true"><i class="on"></i><i></i><i></i><i></i></div>
            </div>

            <div class="meta">
              <h3>Дизайн (обложки/постеры)</h3>
              <p>Графитовая эстетика, чистая типографика и композиция. Пакеты/вариации.</p>
            </div>

            <div class="actions">
              <div class="mini">
                <span>4 кадра</span>
                <span class="barline" aria-hidden="true"><i style="--p:75%"></i></span>
              </div>
              <button class="btn secondary js-photo" type="button">Фото</button>
            </div>
          </div>
        </article>
      </div>
    </section>

    <section class="section" id="cases">
      <div class="section-head">
        <h2 class="h2">Кейсы</h2>
      </div>

      <div class="grid cases">
        <article class="glass card case-card js-case"
                 aria-label="Кейс: Разработка сайта"
                 data-case-id="site"
                 data-case-name="Разработка сайта"
                 data-case-desc="Полный цикл: структура, дизайн, верстка, анимации и адаптив. Визуальная чистота + скорость."
                 data-case-tasks="Аналитика и структура | Дизайн в премиум-минимализме | Верстка (HTML/CSS/JS) | Анимации и оптимизация | Адаптив под мобильные"
                 data-images="assets/cases/site/01.jpg,assets/cases/site/02.jpg,assets/cases/site/03.jpg,assets/cases/site/04.jpg">
          <div class="card-inner">
            <div class="viewer js-viewer" data-kind="case">
              <div class="track"></div>
              <div class="pill" aria-hidden="true"><i class="on"></i><i></i><i></i><i></i></div>
            </div>

            <div class="meta">
              <h3>Разработка сайта</h3>
              <p>Технологичный лендинг/портфолио: стекло, глубина, чистый mobile-first UX.</p>
            </div>

            <div class="actions">
              <span></span>
              <button class="btn secondary js-open-case" type="button">Кейс</button>
            </div>
          </div>
        </article>

        <article class="glass card case-card js-case"
                 aria-label="Кейс: Разработка Telegram-бота"
                 data-case-id="bot"
                 data-case-name="Разработка Telegram-бота"
                 data-case-desc="Быстро и надежно: логика, сценарии, обработчики, интеграции. UX — максимально простой."
                 data-case-tasks="Проектирование сценариев | Клавиатуры/меню | Интеграции (API/таблицы/CRM) | Микрокопирайтинг | Тестирование и запуск"
                 data-images="assets/cases/bot/01.jpg,assets/cases/bot/02.jpg,assets/cases/bot/03.jpg,assets/cases/bot/04.jpg">
          <div class="card-inner">
            <div class="viewer js-viewer" data-kind="case">
              <div class="track"></div>
              <div class="pill" aria-hidden="true"><i class="on"></i><i></i><i></i><i></i></div>
            </div>

            <div class="meta">
              <h3>Разработка Telegram-бота</h3>
              <p>Сценарии, интеграции, стабильная логика. Без токенов во фронте.</p>
            </div>

            <div class="actions">
              <span></span>
              <button class="btn secondary js-open-case" type="button">Кейс</button>
            </div>
          </div>
        </article>

        <article class="glass card case-card js-case"
                 aria-label="Кейс: Дизайн"
                 data-case-id="design"
                 data-case-name="Дизайн (аватарки / превью / постеры)"
                 data-case-desc="Сильная композиция и иерархия. Графитовая премиум-эстетика без ярких акцентов."
                 data-case-tasks="Концепты и стилистика | Сетка и композиция | Типографика | Подготовка для площадок | Пакеты/вариации"
                 data-images="assets/cases/design/01.jpg,assets/cases/design/02.jpg,assets/cases/design/03.jpg,assets/cases/design/04.jpg">
          <div class="card-inner">
            <div class="viewer js-viewer" data-kind="case">
              <div class="track"></div>
              <div class="pill" aria-hidden="true"><i class="on"></i><i></i><i></i><i></i></div>
            </div>

            <div class="meta">
              <h3>Дизайн</h3>
              <p>Аватарки, превью, постеры: тихий premium-минимализм как у студии.</p>
            </div>

            <div class="actions">
              <span></span>
              <button class="btn secondary js-open-case" type="button">Кейс</button>
            </div>
          </div>
        </article>
      </div>
    </section>

    <div id="contacts" aria-hidden="true" style="height:1px;"></div>

    <footer class="socials-float" aria-label="Социальные сети">
      <a class="social" id="tgLink" href="https://t.me/knesit" target="_blank" rel="noopener noreferrer" aria-label="Telegram @knesit">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor" d="M21.8 5.3 18.6 20c-.2 1-1.2 1.2-2 .7l-4.6-3.4-2.2 2.1c-.2.2-.4.4-.8.4l.3-5.2 9.4-8.5c.4-.3-.1-.5-.6-.2l-11.6 7.3-5-1.6c-1.1-.3-1.1-1.1.2-1.6L20 4.6c.9-.3 1.7.2 1.8.7z"/>
        </svg>
        <span class="sr-only">Telegram</span>
      </a>

      <a class="social" id="vkLink" href="https://vk.ru/id832169768" target="_blank" rel="noopener noreferrer" aria-label="VK">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M4.5 7.4c.12 6.2 3.25 10.2 8.7 10.2h.33v-3.55c2.05.2 3.6 1.7 4.22 3.55H21c-.8-2.95-3.3-4.65-4.86-5.3 1.56-.9 3.8-2.9 4.3-5H17.8c-.65 2.15-2.72 4.15-4.27 4.33V7.4h-2.5v7.5c-1.6-.45-3.62-2.62-3.7-7.5H4.5Z"
                fill="currentColor" opacity=".92"/>
        </svg>
        <span class="sr-only">VK</span>
      </a>

      <a class="social" id="ttLink" href="https://www.tiktok.com/@Knes_01" target="_blank" rel="noopener noreferrer" aria-label="TikTok @Knes_01">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M14 4v10.2a3.8 3.8 0 1 1-3.2-3.74V8.2a6.3 6.3 0 1 0 5.7 6.3V9.2c1.1.8 2.5 1.3 4 1.35V8.1c-2.2-.1-4-1.9-4.1-4.1H14Z"
                fill="currentColor" opacity=".92"/>
        </svg>
        <span class="sr-only">TikTok</span>
      </a>
    </footer>
  </main>

  <div class="modal" id="caseModal" aria-hidden="true" aria-modal="true" role="dialog">
    <div class="backdrop js-close" aria-hidden="true"></div>

    <div class="sheet case">
      <div class="modal-top" style="grid-column: 1 / -1;">
        <p class="modal-title">Кейс</p>
        <button class="close js-close" type="button" aria-label="Закрыть">
          <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 6L18 18M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <div class="modal-left">
        <div class="viewer js-modal-viewer" data-kind="modal">
          <div class="track" id="caseTrack"></div>
          <div class="pill" id="caseDots" aria-hidden="true"><i class="on"></i><i></i><i></i><i></i></div>
        </div>
        <div class="navrow">
          <button class="iconbtn" type="button" id="casePrev" aria-label="Предыдущее изображение">
            <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M14.5 5L7.5 12L14.5 19" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button class="iconbtn" type="button" id="caseNext" aria-label="Следующее изображение">
            <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M9.5 5L16.5 12L9.5 19" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>

      <div class="modal-right">
        <h3 class="case-name" id="caseName">Название кейса</h3>
        <p class="case-desc" id="caseDesc">Описание...</p>
        <ul class="work-list" id="caseTasks"></ul>
        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top: 8px;">
          <button class="btn" id="wantBtn" type="button">Хочу так же</button>
          <button class="btn secondary js-close" type="button">Закрыть</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="photoModal" aria-hidden="true" aria-modal="true" role="dialog">
    <div class="backdrop js-photo-close" aria-hidden="true"></div>

    <div class="sheet photo">
      <div class="modal-top">
        <p class="modal-title" id="photoTitle">Фото</p>
        <button class="close js-photo-close" type="button" aria-label="Закрыть">
          <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M6 6L18 18M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <div class="modal-left" style="padding: 6px;">
        <div class="viewer js-photo-viewer" data-kind="photo">
          <div class="track" id="photoTrack"></div>
          <div class="pill" id="photoDots" aria-hidden="true"><i class="on"></i><i></i><i></i><i></i></div>
        </div>
        <div class="navrow">
          <button class="iconbtn" type="button" id="photoPrev" aria-label="Предыдущее изображение">
            <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M14.5 5L7.5 12L14.5 19" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <button class="iconbtn" type="button" id="photoNext" aria-label="Следующее изображение">
            <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M9.5 5L16.5 12L9.5 19" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const CONFIG = {
      orderUsername: "SanyaDur",
      orderTemplate: ({ caseName, slideIndex }) =>
        `Хочу заказать: ${caseName}\n` +
        `Кадр: ${slideIndex}/4\n` +
        `Опишите, пожалуйста, стоимость и сроки.`
    };

    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }
    function parseImages(attr){
      return String(attr || "").split(",").map(s => s.trim()).filter(Boolean).slice(0,4);
    }
    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }
    function setDots(pillEl, idx){
      if (!pillEl) return;
      const dots = pillEl.querySelectorAll("i");
      dots.forEach((d,i)=> d.classList.toggle("on", i===idx));
    }

    const bar = $("#bar");
    let lastY = 0, ticking = false;
    function onScroll(){
      lastY = window.scrollY || 0;
      if (!ticking){
        ticking = true;
        requestAnimationFrame(() => {
          bar.classList.toggle("is-scrolled", lastY > 6);
          ticking = false;
        });
      }
    }
    window.addEventListener("scroll", onScroll, { passive:true });
    onScroll();

    $$("[data-scroll]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const target = $(btn.getAttribute("data-scroll"));
        if (!target) return;
        target.scrollIntoView({ behavior: prefersReduced ? "auto" : "smooth", block: "start" });
      }, { passive:true });
    });

    (function titleTyping(){
      const el = $("#titleText");
      if (!el) return;
      if (prefersReduced) { el.textContent = "Senk"; return; }

      const words = ["Senk", "Сэнк"];

      const SLOW = 2.8;
      const typeSpeed = 60 * SLOW;
      const eraseSpeed = 40 * SLOW;
      const hold = 900 * SLOW;

      const pause = (ms) => new Promise(r => setTimeout(r, ms));

      async function typeTo(text){
        const cur = el.textContent || "";
        if (cur === text) return;
        el.textContent = "";
        for (let i=0;i<text.length;i++){
          el.textContent += text[i];
          await pause(typeSpeed);
        }
      }
      async function erase(){
        let s = el.textContent || "";
        while (s.length){
          s = s.slice(0, -1);
          el.textContent = s;
          await pause(eraseSpeed);
        }
      }

      let idx = 0;
      el.textContent = words[0];

      (async function loop(){
        while(true){
          await pause(hold);
          await erase();
          idx = (idx + 1) % words.length;
          await typeTo(words[idx]);
        }
      })();
    })();

    class Viewer{
      constructor(root, images, { hoverScrub=true } = {}){
        this.root = root;
        this.track = $(".track", root);
        this.pill = $(".pill", root);
        this.images = images;
        this.index = 0;

        this.hoverScrub = hoverScrub;
        this.width = 0;

        this.dragging = false;
        this.startX = 0;
        this.dx = 0;

        this._raf = 0;
        this._pendingRatio = null;

        this._ro = null;

        this._pillTimer = 0;
        this._hovering = false;
        this.pillDelay = 1500;

        this.render();
        this.measure();
        this.bind();
        this.snapTo(0, true);
        this.showPill();
        this.hidePillLater();
      }

      render(){
        this.track.innerHTML = this.images.map((src,i)=>`
          <div class="slide" aria-label="Изображение ${i+1} из 4">
            <img loading="lazy" decoding="async" src="${src}" alt="">
          </div>
        `).join("");
      }

      measure(){ this.width = this.root.getBoundingClientRect().width || 1; }
      setX(px){ this.track.style.setProperty("--x", px + "px"); }

      setPillVisible(visible){
        if (!this.pill) return;
        this.root.dataset.pillHidden = visible ? "false" : "true";
      }

      showPill(){
        this.setPillVisible(true);
        this.hidePillLater();
      }

      hidePillLater(){
        if (!this.pill) return;
        clearTimeout(this._pillTimer);
        this._pillTimer = setTimeout(()=>{
          if (!this.dragging && !this._hovering) this.setPillVisible(false);
        }, this.pillDelay);
      }

      snapTo(idx, instant=false){
        this.index = clamp(idx, 0, 3);
        const x = -this.index * this.width;

        if (instant || prefersReduced){
          const prev = this.track.style.transition;
          this.track.style.transition = "none";
          this.setX(x);
          this.track.offsetHeight;
          this.track.style.transition = prev || "";
        } else {
          this.setX(x);
        }

        setDots(this.pill, this.index);
        this.root.dataset.index = String(this.index);
        this.showPill();
      }

      scheduleByRatio(ratio){
        this._pendingRatio = ratio;
        if (this._raf) return;
        this._raf = requestAnimationFrame(()=>{
          this._raf = 0;
          const r = clamp(this._pendingRatio ?? 0, 0, 0.9999);
          const idx = clamp(Math.floor(r * 4), 0, 3);
          if (idx !== this.index) this.snapTo(idx);
          else this.showPill();
        });
      }

      bind(){
        this._ro = new ResizeObserver(()=>{
          const prev = this.width;
          this.measure();
          if (Math.abs(prev - this.width) > 0.5){
            this.snapTo(this.index, true);
          }
        });
        this._ro.observe(this.root);

        const hoverOk = window.matchMedia("(hover:hover)").matches;

        this.root.addEventListener("mouseenter", ()=>{
          this._hovering = true;
          this.showPill();
        }, { passive:true });

        this.root.addEventListener("mouseleave", ()=>{
          this._hovering = false;
          this.hidePillLater();
        }, { passive:true });

        if (hoverOk && this.hoverScrub){
          this.root.addEventListener("mousemove", (e)=>{
            const rect = this.root.getBoundingClientRect();
            const ratio = (e.clientX - rect.left) / rect.width;
            this.scheduleByRatio(ratio);
          }, { passive:true });
        }

        this.root.addEventListener("pointerdown", (e)=>{
          if (e.pointerType === "mouse" && hoverOk && this.hoverScrub) return;
          this.dragging = true;
          this.showPill();
          this.startX = e.clientX;
          this.dx = 0;
          this.root.setPointerCapture(e.pointerId);
          this.track.style.transition = "none";
        });

        this.root.addEventListener("pointermove", (e)=>{
          if (!this.dragging) return;
          this.showPill();
          this.dx = e.clientX - this.startX;

          let x = -this.index * this.width + this.dx;
          const minX = -3 * this.width;
          const maxX = 0;

          if (x > maxX) x = maxX + (x - maxX) * 0.25;
          if (x < minX) x = minX + (x - minX) * 0.25;

          this.setX(x);
        });

        const end = ()=>{
          if (!this.dragging) return;
          this.dragging = false;
          this.track.style.transition = prefersReduced ? "none" : "";

          const threshold = this.width * 0.18;
          let next = this.index;
          if (this.dx > threshold) next = this.index - 1;
          if (this.dx < -threshold) next = this.index + 1;
          this.snapTo(next);
          this.hidePillLater();
        };

        this.root.addEventListener("pointerup", end);
        this.root.addEventListener("pointercancel", end);
        this.root.addEventListener("lostpointercapture", end);
      }

      destroy(){
        try{ this._ro && this._ro.disconnect(); } catch(e){}
        this._ro = null;
        clearTimeout(this._pillTimer);
        this.track.innerHTML = "";
      }
    }

    $$(".js-viewer").forEach(v=>{
      const caseCard = v.closest(".js-case");
      const imgsAttr = caseCard?.getAttribute("data-images") || v.getAttribute("data-images") || "";
      const images = parseImages(imgsAttr);
      new Viewer(v, images, { hoverScrub:true });
    });

    document.addEventListener("dragstart", (e)=>{
      if (e.target && e.target.tagName === "IMG") e.preventDefault();
    }, { passive:false });

    let _scrollY = 0;
    function lockScroll(lock){
      if (lock){
        _scrollY = window.scrollY || 0;
        document.body.style.position = "fixed";
        document.body.style.top = `-${_scrollY}px`;
        document.body.style.left = "0";
        document.body.style.right = "0";
        document.body.style.width = "100%";
        document.body.style.overflow = "hidden";
      } else {
        document.body.style.position = "";
        document.body.style.top = "";
        document.body.style.left = "";
        document.body.style.right = "";
        document.body.style.width = "";
        document.body.style.overflow = "";
        window.scrollTo(0, _scrollY);
      }
    }
    function openModal(modalEl){
      modalEl.setAttribute("aria-hidden", "false");
      lockScroll(true);
      const closeBtn = modalEl.querySelector("button.close");
      closeBtn && closeBtn.focus({ preventScroll:true });
    }
    function closeModal(modalEl){
      modalEl.setAttribute("aria-hidden", "true");
      lockScroll(false);
    }

    window.addEventListener("keydown", (e)=>{
      if (e.key !== "Escape") return;
      const open = $$(".modal").find(m => m.getAttribute("aria-hidden") === "false");
      if (open) closeModal(open);
    });

    const caseModal = $("#caseModal");
    const caseDots  = $("#caseDots");
    const caseName  = $("#caseName");
    const caseDesc  = $("#caseDesc");
    const caseTasks = $("#caseTasks");
    const wantBtn   = $("#wantBtn");
    const casePrev  = $("#casePrev");
    const caseNext  = $("#caseNext");
    const caseViewerRoot = $(".js-modal-viewer");

    let activeCase = null;
    let caseViewer = null;
    let caseObs = null;

    function openCase(caseEl){
      const name = caseEl.getAttribute("data-case-name") || "Кейс";
      const desc = caseEl.getAttribute("data-case-desc") || "";
      const tasksRaw = caseEl.getAttribute("data-case-tasks") || "";
      const images = parseImages(caseEl.getAttribute("data-images") || "");

      activeCase = { name, images };

      caseName.textContent = name;
      caseDesc.textContent = desc;

      const tasks = tasksRaw.split("|").map(s=>s.trim()).filter(Boolean);
      caseTasks.innerHTML = tasks.map(t=>`
        <li><span class="b" aria-hidden="true"></span><span>${escapeHtml(t)}</span></li>
      `).join("");

      if (caseObs){ caseObs.disconnect(); caseObs = null; }
      if (caseViewer){ caseViewer.destroy(); caseViewer = null; }

      caseViewer = new Viewer(caseViewerRoot, images, { hoverScrub:false });

      caseObs = new MutationObserver(()=> setDots(caseDots, caseViewer.index));
      caseObs.observe(caseViewerRoot, { attributes:true, attributeFilter:["data-index"] });

      setDots(caseDots, 0);
      openModal(caseModal);
    }

    function closeCase(){
      if (caseObs){ caseObs.disconnect(); caseObs = null; }
      if (caseViewer){ caseViewer.destroy(); caseViewer = null; }
      activeCase = null;
      closeModal(caseModal);
    }

    $$(".js-close", caseModal).forEach(el => el.addEventListener("click", closeCase));

    $$(".js-open-case").forEach(btn=>{
      btn.addEventListener("click", (e)=>{
        e.stopPropagation();
        const card = btn.closest(".js-case");
        if (card) openCase(card);
      });
    });

    casePrev.addEventListener("click", ()=>{
      if (!caseViewer) return;
      caseViewer.snapTo(caseViewer.index - 1);
      setDots(caseDots, caseViewer.index);
    });
    caseNext.addEventListener("click", ()=>{
      if (!caseViewer) return;
      caseViewer.snapTo(caseViewer.index + 1);
      setDots(caseDots, caseViewer.index);
    });

    wantBtn.addEventListener("click", ()=>{
      if (!activeCase || !caseViewer) return;
      const slideIndex = caseViewer.index + 1;
      const text = CONFIG.orderTemplate({ caseName: activeCase.name, slideIndex });
      const url = `https://t.me/${encodeURIComponent(CONFIG.orderUsername)}?text=${encodeURIComponent(text)}`;
      window.open(url, "_blank", "noopener");
    });

    const photoModal = $("#photoModal");
    const photoDots  = $("#photoDots");
    const photoTitle = $("#photoTitle");
    const photoPrev  = $("#photoPrev");
    const photoNext  = $("#photoNext");
    const photoViewerRoot = $(".js-photo-viewer");

    let photoViewer = null;
    let photoObs = null;

    function openPhotoFromProject(btn){
      const card = btn.closest("article");
      const viewerEl = $(".js-viewer[data-kind='project']", card);
      if (!viewerEl) return;

      const title = viewerEl.getAttribute("data-title") || "Фото";
      const images = parseImages(viewerEl.getAttribute("data-images") || "");

      photoTitle.textContent = `Фото — ${title}`;

      if (photoObs){ photoObs.disconnect(); photoObs = null; }
      if (photoViewer){ photoViewer.destroy(); photoViewer = null; }

      photoViewer = new Viewer(photoViewerRoot, images, { hoverScrub:false });

      photoObs = new MutationObserver(()=> setDots(photoDots, photoViewer.index));
      photoObs.observe(photoViewerRoot, { attributes:true, attributeFilter:["data-index"] });

      setDots(photoDots, 0);
      openModal(photoModal);
    }

    function closePhoto(){
      if (photoObs){ photoObs.disconnect(); photoObs = null; }
      if (photoViewer){ photoViewer.destroy(); photoViewer = null; }
      closeModal(photoModal);
    }

    $$(".js-photo").forEach(btn=>{
      btn.addEventListener("click", (e)=>{
        e.stopPropagation();
        openPhotoFromProject(btn);
      });
    });

    $$(".js-photo-close", photoModal).forEach(el => el.addEventListener("click", closePhoto));

    photoModal.addEventListener("click", (e) => {
      if (e.target === photoModal.querySelector(".backdrop")) closePhoto();
    });
    photoModal.querySelector(".sheet")?.addEventListener("click", (e) => e.stopPropagation());

    photoPrev.addEventListener("click", ()=>{
      if (!photoViewer) return;
      photoViewer.snapTo(photoViewer.index - 1);
      setDots(photoDots, photoViewer.index);
    });
    photoNext.addEventListener("click", ()=>{
      if (!photoViewer) return;
      photoViewer.snapTo(photoViewer.index + 1);
      setDots(photoDots, photoViewer.index);
    });

    const canvas = $("#fx");
    const ctx = canvas.getContext("2d", { alpha:true });

    let fxMode = "off";
    let W=0, H=0, DPR=1;

    const FX = {
      rain:{ drops:[], layers:3 },
      snow:{ flakes:[], layers:3 },
      lastT:0,
      rafId:0
    };

    const RAIN = { wind:14, slant:0.17, resetPad:40, speedMul:0.5 };

    function resizeCanvas(){
      DPR = Math.min(window.devicePixelRatio || 1, 2);
      W = Math.floor(window.innerWidth);
      H = Math.floor(window.innerHeight);
      canvas.width = Math.floor(W * DPR);
      canvas.height = Math.floor(H * DPR);
      canvas.style.width = W + "px";
      canvas.style.height = H + "px";
      ctx.setTransform(DPR,0,0,DPR,0,0);
      rebuildFX();
    }

    function areaBasedCount(){
      const area = W * H;
      const base = Math.sqrt(area) * 0.26;
      return clamp(Math.floor(base), 60, 180);
    }

    function rebuildFX(){
      FX.rain.drops.length = 0;
      FX.snow.flakes.length = 0;

      const n = areaBasedCount();

      if (fxMode === "rain"){
        for (let l=0; l<FX.rain.layers; l++){
          const depth = (l+1) / FX.rain.layers;
          const count = Math.floor(n * (0.5 + depth*0.4));
          for (let i=0; i<count; i++) FX.rain.drops.push(makeDrop(depth));
        }
      }

      if (fxMode === "snow"){
        for (let l=0; l<FX.snow.layers; l++){
          const depth = (l+1) / FX.snow.layers;
          const count = Math.floor(n * (0.35 + depth*0.35));
          for (let i=0; i<count; i++) FX.snow.flakes.push(makeFlake(depth));
        }
      }
    }

    function lerp(a,b,t){ return a + (b-a)*t; }

    function makeDrop(depth){
      const speed = lerp(560, 980, depth) * (0.85 + Math.random()*0.25);
      const len   = lerp(16, 34, depth)  * (0.8 + Math.random()*0.45);
      const x = Math.random() * W;
      const y = -Math.random() * H;
      const w = lerp(0.7, 1.15, depth);
      const a = lerp(0.10, 0.22, depth);
      const drift = (Math.random() * 2 - 1) * lerp(8, 22, depth);
      return { x, y, speed, len, w, a, depth, drift };
    }

    function makeFlake(depth){
      const r = lerp(1.0, 2.2, depth) * (0.8 + Math.random()*0.7);
      const speed = lerp(26, 70, depth) * (0.8 + Math.random()*0.55);
      const drift = lerp(10, 28, depth) * (Math.random() < .5 ? -1 : 1);
      const x = Math.random() * W;
      const y = Math.random() * H;
      const a = lerp(0.12, 0.26, depth);
      const phase = Math.random() * Math.PI * 2;
      return { x,y, r, speed, drift, a, phase, depth };
    }

    function clear(){ ctx.clearRect(0,0,W,H); }

    function drawRain(dt){
      ctx.lineCap = "round";
      ctx.strokeStyle = "rgba(255,255,255,1)";
      const wind = RAIN.wind;
      const slantK = RAIN.slant;
      const pad = RAIN.resetPad;
      const sm = RAIN.speedMul;

      for (const d of FX.rain.drops){
        d.y += d.speed * dt * sm;
        d.x += (wind + d.drift) * dt * (0.35 + d.depth * 0.65) * sm;

        if (d.x < -20) d.x = W + 20;
        if (d.x > W + 20) d.x = -20;

        if (d.y - d.len > H + pad){
          d.y = -Math.random() * (H * 0.35) - d.len;
          d.x = Math.random() * W;
        }

        const slant = d.len * slantK * (0.45 + d.depth * 0.55);

        ctx.globalAlpha = d.a;
        ctx.lineWidth = d.w;

        ctx.beginPath();
        ctx.moveTo(d.x, d.y);
        ctx.lineTo(d.x + slant, d.y + d.len);
        ctx.stroke();
      }
      ctx.globalAlpha = 1;
    }

    function drawSnow(dt, t){
      for (const f of FX.snow.flakes){
        f.y += f.speed * dt;
        const sway = Math.sin(t*0.9 + f.phase) * (f.drift * 0.02);
        f.x += sway;

        if (f.y - f.r > H){
          f.y = -Math.random()*H*0.15;
          f.x = Math.random()*W;
        }
        if (f.x < -10) f.x = W + 10;
        if (f.x > W + 10) f.x = -10;

        ctx.globalAlpha = f.a;
        ctx.fillStyle = "rgba(255,255,255,1)";
        ctx.beginPath();
        ctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
        ctx.fill();
      }
      ctx.globalAlpha = 1;
    }

    function tick(ts){
      if (!FX.lastT) FX.lastT = ts;
      const dt = Math.min((ts - FX.lastT) / 1000, 0.033);
      FX.lastT = ts;

      clear();
      if (fxMode === "rain") drawRain(dt);
      if (fxMode === "snow") drawSnow(dt, ts/1000);

      FX.rafId = requestAnimationFrame(tick);
    }

    function startFX(){ if (!FX.rafId) FX.rafId = requestAnimationFrame(tick); }
    function stopFX(){
      if (FX.rafId){ cancelAnimationFrame(FX.rafId); FX.rafId = 0; }
      FX.lastT = 0;
      clear();
    }

    function setFX(mode, silent=false){
      fxMode = mode;
      try { localStorage.setItem("seng_fx_mode", mode); } catch(e){}

      if (!silent){
        $$(".fxbtn").forEach(b=>{
          b.setAttribute("aria-pressed", b.dataset.fx === mode ? "true" : "false");
        });
      }

      if (mode === "off"){ stopFX(); return; }
      rebuildFX();
      startFX();
    }

    resizeCanvas();
    window.addEventListener("resize", ()=> requestAnimationFrame(resizeCanvas), { passive:true });

    $$(".fxbtn").forEach(btn=>{
      btn.addEventListener("click", ()=> setFX(btn.dataset.fx), { passive:true });
    });

    document.addEventListener("visibilitychange", ()=>{
      if (document.hidden) stopFX();
      else if (fxMode !== "off") startFX();
    });

    (function initFX(){
      let saved = "off";
      try { saved = localStorage.getItem("seng_fx_mode") || "off"; } catch(e){}
      saved = (saved === "rain" || saved === "snow" || saved === "off") ? saved : "off";
      $$(".fxbtn").forEach(b=>{
        b.setAttribute("aria-pressed", b.dataset.fx === saved ? "true" : "false");
      });
      setFX(saved, true);
      if (saved !== "off"){ rebuildFX(); startFX(); }
    })();
  </script>
</body>
</html>
